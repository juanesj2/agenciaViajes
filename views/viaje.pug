extends ./layout/index

block contenido
    main.container.mt-5
        .row
            .col-md-5
                img(src=`/img/destinos_${resultado.imagen}_ln.jpg`, alt="imagen viaje", class="img-fluid")
            .col-md-7
                h1 #{resultado.titulo}
                p
                    svg.icon.icon-tabler.icon-tabler-calendar-time(xmlns='http://www.w3.org/2000/svg' width='44' height='44' viewbox='0 0 24 24' stroke-width='1.5'
                        stroke='#fd0061' fill='none' stroke-linecap='round' stroke-linejoin='round')
                        path(stroke='none' d='M0 0h24v24H0z' fill='none')
                        path(d='M11.795 21h-6.795a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v4')
                        path(d='M18 18m-4 0a4 4 0 1 0 8 0a4 4 0 1 0 -8 0')
                        path(d='M15 3v4')
                        path(d='M7 3v4')
                        path(d='M3 11h16')
                        path(d='M18 16.496v1.504l1 1')
                    |   #{resultado.fecha_ida} - #{resultado.fecha_vuelta}
                p
                    svg.icon.icon-tabler.icon-tabler-coin-euro(xmlns='http://www.w3.org/2000/svg' width='44' height='44' viewbox='0 0 24 24' stroke-width='1.5'
                        stroke='#fd0061' fill='none' stroke-linecap='round' stroke-linejoin='round')
                        path(stroke='none' d='M0 0h24v24H0z' fill='none')
                        path(d='M12 12m-9 0a9 9 0 1 0 18 0a9 9 0 1 0 -18 0')
                        path(d='M14.401 8c-.669 -.628 -1.5 -1 -2.401 -1c-2.21 0 -4 2.239 -4 5s1.79 5 4 5c.9 0 1.731 -.372 2.4 -1')
                        path(d='M7 10.5h4')
                        path(d='M7 13.5h4')
                    |   #{resultado.precio} Euros

                p
                    svg.icon.icon-tabler.icon-tabler-users(xmlns='http://www.w3.org/2000/svg' width='44' height='44' viewbox='0 0 24 24' stroke-width='1.5'
                        stroke='#fd0061' fill='none' stroke-linecap='round' stroke-linejoin='round')
                        path(stroke='none' d='M0 0h24v24H0z' fill='none')
                        path(d='M9 7m-4 0a4 4 0 1 0 8 0a4 4 0 1 0 -8 0')
                        path(d='M3 21v-2a4 4 0 0 1 4 -4h4a4 4 0 0 1 4 4v2')
                        path(d='M16 3.13a4 4 0 0 1 0 7.75')
                        path(d='M21 21v-2a4 4 0 0 0 -3 -3.85')
                    |   #{resultado.disponibles} Disponibles

                p=resultado.descripcion
        hr(style='border:solid 1px black;')

        .row
            // Nuestra modificacion va a ser meter un mapa que muestre la ubicacion del sitio que hemos seleccionado
            .col-md-12.text-center
                h1.text-center.m-5 Mapa De #{resultado.titulo}
                //El enlace del mapa tiene que tener esta estructura
                //https://www.google.com/maps?q=${latitud},${longitud}&output=embed
                .col-md-12.d-flex.justify-content-center
                iframe(src=`https://www.google.com/maps?q=${resultado.latitud},${resultado.longitud}&output=embed` width='100%' height='500' style='border:0;' allowfullscreen='' loading='lazy')

                //iframe(width='600' height='450' style='border:0' loading='lazy' allowfullscreen='' referrerpolicy='no-referrer-when-downgrade' src='https://www.google.com/maps/embed/v1/place?key=TU_CLAVE_AQUI\
                //&q=Space+Needle,Seattle+WA')

                div#map

                script.
                    // Ponemos como posicion inicial espaÃ±a por ejemplo
                    var map = L.map('map').setView([40.4168, -3.7038], 5);

                    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                        attribution: '&copy; OpenStreetMap contributors'
                    }).addTo(map);

                    fetch(`https://nominatim.openstreetmap.org/search?format=json&q=#{encodeURIComponent(resultado.titulo)}`)
                        .then(res => res.json())
                        .then(data => {
                            if (data.length === 0) return;

                            var lat = data[0].lat, lon = data[0].lon;
                            map.setView([lat, lon], 10);
                            L.marker([lat, lon]).addTo(map).bindPopup("#{resultado.titulo}").openPopup();
                        })
                        .catch(console.error);